From 11abd0e02c16f9e0b6944aea4ef0f2df44b42dd4 Mon Sep 17 00:00:00 2001
From: Simon Josefsson <simon@josefsson.org>
Date: Thu, 14 Jan 2016 14:09:29 +0100
Subject: [PATCH] Fix memory leak in last fix.

---
 lib/idna.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/lib/idna.c b/lib/idna.c
index 0ccd102..3ab1869 100644
--- a/lib/idna.c
+++ b/lib/idna.c
@@ -213,7 +213,10 @@ step3:
     if (i < 64)
       out[i] = '\0';
     else
-      return IDNA_INVALID_LENGTH;
+      {
+	free (src);
+	return IDNA_INVALID_LENGTH;
+      }
     if (inasciirange)
       goto step8;
   }
-- 
2.1.4

